<!DOCTYPE html>
<html>
<head>
	<meta charset=utf-8 />
	<title>What's My Trash Day?</title>

	<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' />
	<script src='https://api.tiles.mapbox.com/mapbox.js/v1.6.1/mapbox.js'></script>
	<link href='https://api.tiles.mapbox.com/mapbox.js/v1.6.1/mapbox.css' rel='stylesheet' />
	<script src='http://code.jquery.com/jquery-1.9.1.min.js'></script>
	<script src='http://code.jquery.com/ui/1.9.2/jquery-ui.js'></script>
	<!---
	<script type'text/javascript' src='./plugins/jquery.dstk.js'></script> -->
	<link rel='stylesheet' href='http://yui.yahooapis.com/pure/0.4.2/pure-min.css'>

	<style>

	</style>
</head>
<body>
	<div id='address'>
		<h1>What's your trash day?<h1>
		<form class='pure-form' id='geocode'>
			<fieldset>
				<legend>Enter your adddress:</legend>
				<input type='text' id='formValueId' name='valueId' value='332 Blackburn Ave, Lexington, KY 40508'/>
				<input type='submit' class='pure-button' id='theButton' value='Click here!' />
			</fieldset>
		</form>
	</div>
	<div id='day'></div>

	<script src='./plugins/leaflet-pip.min.js'></script>
	<script src='./data/solidwastequads.js'></script>
	<script>

		//var dstk = $.DSTK();

		var quadToDay = {
			"A": "Monday",
			"B": "Thursday",
			"C": "Tuesday",
			"D": "Friday",
			"E": "Daily"
		};

		function onLocationFound(ll) {
			var layer = leafletPip.pointInLayer(ll, quads);
			var quad = layer[0].feature.properties.QUAD;
			var pickupDay = quadToDay[quad];

			document.getElementById('day').innerHTML = layer.length ? '<h2>Your trash gets picked up on ' + pickupDay + '</h2>' : '';
		};
	
		var quads = L.geoJson(quadsJson);

		onLocationFound(L.latLng(38.060403, -84.508001));

		/* function geocodeAddress() {
			var address = '#geocode'.val();
			console.log(address);
			var url = 'http://nominatim.openstreetmap.org/search?q=' + encodeURIComponent(address) + '&format=json&limit=1&addressdetails=1';

			$.getJSON(url, function(data) {
				onLocationFound(L.latLng(data[0].lat), L.latLng(data[0].lon));
			});
		}; */

		/*$('geocode').submit(function() {
			console.log('#formValueId'.val());
			var address = '#formValueId'.val();
			console.log(address);
			var url = 'http://nominatim.openstreetmap.org/search?q=' + encodeURIComponent(address) + '&format=json&limit=1&addressdetails=1';

			$.getJSON(url, function(data) {

				onLocationFound(L.latLng(data[0].lat, data[0].lon));
			});
		}); */

		/*$('#geocode').submit(function(e) {
			dstk.street2coordinates( [$('#formValueId').val()], function(result) {
				console.log(result);
				if (typeof result['error'] !== 'undefined') {
					alert('Error: '+result['error']);
					return
				}
				for (var add in result) {
					var info = result[add];
					onLocationFound(L.latLng(info['latitude'], info['longitude']));
				}
			});
			e.preventDefault();
		}); */
	</script>
</body>
</html>
